define(["app"],function(app){app.controller("UserListCtrl",["$scope","$route","$routeParams","$http","$timeout","$mdDialog","calendar",function($scope,$route,$routeParams,$http,$timeout,$mdDialog,calendar){$scope.predicate="fname",$scope.reverse=!1;var oid=$routeParams.oid,userListFunc=function(e){var o=e;userList=[];for(var r=0;r<o.length;r++){var a=o[r];userList.push({conf:a.conf,firstName:a.firstName,lastName:a.lastName,email:a.email,ctcNo:a.contactNo,id:a.maskId})}$scope.userList=Immutable.List(userList),o=null};getHTTP($http,bookingUsersURL+"/"+oid+"/users",userListFunc);var jsonCalId=eval("({'id':{'$oid':'"+oid+"'}})");$scope.calInfo=calendar[_.findIndex(calendar,jsonCalId)],$scope.unsubuser=function(e,o){$scope.flag=!0;var r=$scope.calInfo.id;$scope.formData={_id:r,userId:e};var a=$mdDialog.confirm().title("Unsubscribe user").content("Are you sure to remove the user from your reserve list?").ariaLabel("Good Luck").ok("Yes").cancel("No").targetEvent(o);$mdDialog.show(a).then(function(){var e=function(){$scope.calInfo.avail=$scope.calInfo.avail+1,$scope.flag=!1,$route.reload()},r=function(e){$scope.showAlert(o,e.errors),$scope.flag=!1},a=function(){$scope.showAlert(o,"Please try again later, or inform the us."),$scope.flag=!1};funcHTTP($http,"DELETE",cmdreservationURL,$scope.formData,e,r,a)},function(){$scope.flag=!1})},$scope.confirmuser=function(e){$scope.flag=!0;var o=$scope.calInfo.id,r={_id:o,userId:e},a=function(){$route.reload(),$scope.flag=!1},t=function(e){$scope.showAlert("error",e.errors),$scope.flag=!1},s=function(e){$scope.showAlert("error",e.errors),$scope.flag=!1};funcHTTP($http,"POST",cmdreservationURL,r,a,t,s)},$scope.showAlert=function(e,o){$mdDialog.show($mdDialog.alert().title("Opps, Error Encountered").content(o).ariaLabel("Error").ok("Ok!").targetEvent(e))}}])});