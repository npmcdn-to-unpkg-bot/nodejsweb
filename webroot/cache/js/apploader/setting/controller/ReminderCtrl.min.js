define(["app","modalInstance"],function(e){function a(e){e.r_day=void 0==e.r_day?!1:e.r_day,e.r_week=void 0==e.r_week?!1:e.r_week,e.chk_email=void 0==e.chk_email?!1:e.chk_email,e.chk_sms=void 0==e.chk_sms?!1:e.chk_sms,e.allowCreation=void 0==e.allowCreation?!1:e.allowCreation;var a=[];e.r_day&&a.push(1),e.r_week&&a.push(7);var i={reminderDays:a,alertEmail:e.chk_email?e.n_email:"",allowCreation:e.allowCreation};return e.chk_email||delete i.alertEmail,i}function i(e){return e.chk_email&&(""==e.setting.n_email.$viewValue||void 0==e.setting.n_email.$viewValue)}e.controller("ReminderCtrl",["$scope","$http","$modal","$routeParams",function(e,l,r){e.emailValidate="Resend Email Validation",e.isValidEmail=!0,e.clickCreate=adminCreateUrl,e.allowSetup=!cookieAccess("Cal_Ctrl"),e.succ=function(a){"ok"!=a.success&&(e.r_day=void 0!=a.reminderDays&&a.reminderDays.indexOf(1)>-1,e.r_week=void 0!=a.reminderDays&&a.reminderDays.indexOf(7)>-1,void 0!=a.alertEmail&&""!=a.alertEmail&&(e.chk_email=!0,e.n_email=a.alertEmail,e.str_email=a.alertEmail,e.isValidEmail=a.validEmail),void 0!=a.alertSMS&&""!=a.alertSMS&&(e.chk_sms=!0,e.n_sms=a.alertSMS),e.allowCreation=a.allowCreation)},getHTTP(l,subsReminderURL,e.succ),e.save=function(){if(e.errors=void 0,!e.flag){if(0==e.setting.$valid||i(e))return e.flag=!1,void 0;e.flag=!0,e.formData=a(e);var r=function(){e.str_email!=e.n_email&&(e.isValidEmail=!1),e.open(),e.flag=!1},n=function(a){e.errors=a.errors,e.flag=!1},t=function(a){e.errors=a.errors,e.flag=!1};funcHTTP(l,"POST",subsReminderURL,e.formData,r,n,t)}},e.cancel=cancelBtn,e.open=function(){r.open({templateUrl:"popupdialog.html",controller:"ModalInstanceCtrl",backdrop:"static",resolve:{}})},e.resentEmailValidator=function(){e.emailValidateFlag=!0,e.succ2=function(){e.emailValidate="Sent"},getHTTP(l,emailVerificationURL,e.succ2)}}])});